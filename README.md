# Quick Response Bot

Telegram-бот для быстрого получения информации по любым вопросам. Бот использует OpenRouter API с моделью Google Gemini Pro для генерации кратких, но информативных ответов на запросы пользователей.

---

## Содержание

- [Описание проекта](#описание-проекта)
- [Особенности и функциональность](#особенности-и-функциональность)
- [Архитектура проекта](#архитектура-проекта)
- [Установка и запуск](#установка-и-запуск)
- [Конфигурация](#конфигурация)
- [Команды бота](#команды-бота)
- [Структура проекта](#структура-проекта)
- [Контрибуция](#контрибуция)
- [Лицензия](#лицензия)
- [Функции бота](#функции-бота)

---

## Описание проекта

Этот Telegram-бот предназначен для быстрого получения информации по любым вопросам. Бот выступает в роли интеллектуального помощника и помогает:

- **Получать быстрые ответы.** Бот использует Google Gemini Pro через OpenRouter API для генерации кратких, но информативных ответов.
- **Структурировать информацию.** Ответы форматируются с помощью Markdown для лучшей читаемости.
- **Предоставлять дополнительные ресурсы.** При необходимости бот может предложить ссылки на дополнительные материалы.
- **Работать в реальном времени.** Ответы генерируются потоково, что позволяет видеть результат постепенно.

---

## Особенности и функциональность

- **Приветственное сообщение.** Команда `/start` выводит вводное сообщение с инструкциями по работе с ботом.
- **Быстрые ответы.** Просто отправьте свой вопрос, и бот предоставит структурированный ответ.
- **Форматирование текста.** Бот поддерживает Markdown для лучшей читаемости ответов.
- **Потоковая генерация.** Ответы генерируются постепенно, что позволяет видеть результат в реальном времени.

---

## Архитектура проекта

Проект построен на платформе Deno с использованием библиотеки [grammy](https://deno.land/x/grammy) для работы с Telegram Bot API. Основные компоненты проекта:

- **Контроллеры:** Логика работы реализована в файлах `src/features`:
  - `start/controller.ts` — обработка команды `/start`.
  - `quickResponse/controller.ts` — обработка запросов и генерация ответов.
- **Сервисы:** Модуль `src/features/quickResponse/service.ts` отвечает за взаимодействие с OpenRouter API.
- **Утилиты:** Модуль `src/utils/formatting.ts` отвечает за форматирование текста и обработку Markdown.
- **Основной цикл бота:** Файл `src/index.ts` инициализирует бота и регистрирует обработчики.

---

## Установка и запуск

### Требования

- [Deno](https://deno.land) (версия 1.0 или выше)
- Доступ к сети Интернет (для работы с Telegram API и OpenRouter)

### Клонирование репозитория

```bash
git clone https://github.com/your-username/quick-response-bot.git
cd quick-response-bot
```

### Установка зависимостей

Deno автоматически подгружает необходимые зависимости при запуске, поэтому дополнительных действий не требуется.

### Настройка переменных окружения

Создайте в корневой директории файл `.env` и внесите туда следующие значения:

```env
BOT_TOKEN=ваш-токен-бота
OPENROUTER_API_KEY=ваш_ключ_OpenRouter_API
OPENROUTER_API_URL=https://openrouter.ai/api/v1/chat/completions
OPENROUTER_MODEL=google/gemini-pro
SITE_URL=адрес_вашего_сайта
SITE_NAME=название_сайта
MODE=development  # или production, в зависимости от среды запуска
```

### Запуск бота

Запустите бота с помощью команды:

```bash
deno task start
```

Для разработки можно использовать горячую перезагрузку:

```bash
deno task dev
```

---

## Конфигурация

Основные настройки проекта находятся в следующих файлах:

- **deno.jsonc** — описание задач запуска, форматирования и линтинга.
- **.env** — переменные окружения для работы бота (токены, ключи, режим запуска).
- **tsconfig.json** — конфигурация TypeScript.

---

## Команды бота

- **/start** — выводит приветственное сообщение с краткой информацией о возможностях бота.
- **Любой текст** — бот обработает ваш запрос и предоставит информативный ответ.

---

## Структура проекта

```
├── .env                 // Файл с переменными окружения
├── README.md            // Этот файл
├── LICENSE              // Лицензия на проект (MIT)
├── deno.jsonc           // Конфигурация задач Deno
├── tsconfig.json        // Конфигурация TypeScript
└── src
    ├── index.ts         // Точка входа в приложение
    ├── config           // Конфигурация OpenRouter API
    ├── features         // Основные функции бота
    │   ├── start       // Обработка команды /start
    │   ├── quickResponse // Обработка запросов
    │   └── menu        // Меню бота
    ├── infrastructure   // Инфраструктурный код
    │   └── bot         // Настройка и инициализация бота
    └── utils           // Вспомогательные утилиты
```

---

## Контрибуция

Мы рады любым улучшениям и предложениям! Если вы хотите внести вклад в развитие проекта:

1. Сделайте fork репозитория.
2. Создайте новую ветку для своей фичи или исправления.
3. Внесите изменения, сопровождая их подробными комментариями.
4. Отправьте pull request с описанием ваших изменений.

---

## Лицензия

Проект распространяется под [MIT лицензией](LICENSE). Это означает, что вы можете свободно использовать, изменять и распространять проект при условии сохранения лицензии и уведомления об авторских правах.

---

## Функции бота

### Реагирование на посты в канале

Бот может автоматически реагировать на посты в Telegram-канале и отвечать пользователям, которые комментируют его сообщения.

#### Настройка работы с каналом

1. Добавьте бота в качестве администратора вашего канала
2. Убедитесь, что у бота есть права на публикацию сообщений
3. Бот будет автоматически комментировать новые посты в канале
4. Если пользователь ответит на комментарий бота, бот ответит пользователю

#### Настройка прав бота для работы с каналом

Для корректной работы с каналом, боту необходимы следующие права:

- Добавление новых администраторов
- Публикация сообщений
- Редактирование сообщений других пользователей
- Удаление сообщений других пользователей

#### Настройка фильтров для постов

По умолчанию бот реагирует на все текстовые посты в канале. Вы можете настроить фильтрацию в файле `src/features/channelPosts/service.ts`, изменив функцию `shouldReactToPost`.
